<!DOCTYPE html>
<html lang="es" class="h-full">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/jpeg" href="images/logo.jpg" id="favicon" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>..::SGO::..</title>
    <script>
      // Función para crear un favicon redondeado
      function createRoundedFavicon() {
        const canvas = document.createElement('canvas');
        const size = 32; // Tamaño del favicon
        canvas.width = size;
        canvas.height = size;
        const ctx = canvas.getContext('2d');
        
        const img = new Image();
        
        img.onload = function() {
          // Limpiar el canvas
          ctx.clearRect(0, 0, size, size);
          
          // Crear un círculo
          ctx.save();
          ctx.beginPath();
          ctx.arc(size/2, size/2, size/2, 0, Math.PI * 2, true);
          ctx.closePath();
          ctx.clip();
          
          // Dibujar la imagen dentro del círculo
          const scale = Math.min(size / img.width, size / img.height);
          const x = (size - img.width * scale) / 2;
          const y = (size - img.height * scale) / 2;
          ctx.drawImage(img, x, y, img.width * scale, img.height * scale);
          
          // Restaurar el contexto
          ctx.restore();
          
          // Agregar un borde al círculo
          ctx.beginPath();
          ctx.arc(size/2, size/2, size/2, 0, Math.PI * 2, true);
          ctx.strokeStyle = '#ffffff';
          ctx.lineWidth = 2;
          ctx.stroke();
          
          try {
            // Actualizar el favicon
            const favicon = document.getElementById('favicon');
            const dataUrl = canvas.toDataURL('image/png');
            if (favicon) {
              favicon.href = dataUrl;
            }
            
            // Crear un favicon alternativo para el modo oscuro
            const darkCanvas = document.createElement('canvas');
            darkCanvas.width = size;
            darkCanvas.height = size;
            const darkCtx = darkCanvas.getContext('2d');
            
            // Copiar la imagen original
            darkCtx.drawImage(canvas, 0, 0);
            
            // Agregar un borde negro para el modo oscuro
            darkCtx.beginPath();
            darkCtx.arc(size/2, size/2, size/2, 0, Math.PI * 2, true);
            darkCtx.strokeStyle = '#000000';
            darkCtx.lineWidth = 2;
            darkCtx.stroke();
            
            // Actualizar o crear el favicon para modo oscuro
            let darkFavicon = document.querySelector('link[media="(prefers-color-scheme: dark)"]');
            if (!darkFavicon) {
              darkFavicon = document.createElement('link');
              darkFavicon.rel = 'icon';
              darkFavicon.media = '(prefers-color-scheme: dark)';
              document.head.appendChild(darkFavicon);
            }
            darkFavicon.href = darkCanvas.toDataURL('image/png');
          } catch (e) {
            console.error('Error creating favicon:', e);
          }
        };
        
        img.onerror = function(e) {
          console.error('Error loading image for favicon:', e);
          // Usar el favicon por defecto en caso de error
          const favicon = document.getElementById('favicon');
          if (favicon) {
            favicon.href = 'images/logo.jpg';
          }
        };

        // Cargar la imagen usando una ruta relativa
        img.src = 'images/logo.jpg';
      }

      // Esperar a que el DOM esté completamente cargado
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', createRoundedFavicon);
      } else {
        createRoundedFavicon();
      }
      // Actualizar cuando cambie el tema
      window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', createRoundedFavicon);
    </script>
    <script type="text/javascript">
      // Single Page Apps for GitHub Pages
      // MIT License
      // https://github.com/rafgraph/spa-github-pages
      (function(l) {
        if (l.search[1] === '/' ) {
          var decoded = l.search.slice(1).split('&').map(function(s) { 
            return s.replace(/~and~/g, '&')
          }).join('?');
          window.history.replaceState(null, null,
              l.pathname.slice(0, -1) + decoded + l.hash
          );
        }
      }(window.location))
    </script>
    <script>
      // Theme handling
      if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
        document.documentElement.classList.add('dark')
      } else {
        document.documentElement.classList.remove('dark')
      }
    </script>
  </head>
  <body class="h-full bg-gray-50 dark:bg-gray-900">
    <div id="root" class="h-full"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
